{% extends "base.html" %}

{% block content %}
<div class="content-wrapper">
    <h1 class="display-4 mb-5 text-center">Edit Your Story</h1>
    
    <div class="story-editor mb-5">
        {% for paragraph in story.paragraphs %}
        <div class="paragraph-container mb-4" data-index="{{ loop.index0 }}">
            <div class="card">
                <div class="card-body">
                    <textarea class="form-control paragraph-text mb-3" rows="4">{{ paragraph.text }}</textarea>
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary save-paragraph">Save Changes</button>
                        <button class="btn btn-secondary regenerate-image">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                            </svg>
                            Regenerate Image
                        </button>
                        <button class="btn btn-secondary regenerate-audio">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                                <path d="M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z"/>
                                <path d="M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z"/>
                                <path d="M8.707 11.182A4.486 4.486 0 0 0 10.025 8a4.486 4.486 0 0 0-1.318-3.182L8 5.525A3.489 3.489 0 0 1 9.025 8 3.49 3.49 0 0 1 8 10.475l.707.707zM6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z"/>
                            </svg>
                            Regenerate Audio
                        </button>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="d-flex justify-content-center gap-3">
        <a href="/" class="btn btn-secondary">Back to Prompt</a>
        <a href="/story/generate" class="btn btn-primary">Generate Cards</a>
    </div>
</div>

<div id="log-output" class="mt-5 mb-5">
    <h3 class="h4 mb-3">Generation Progress</h3>
    <div id="log-content" class="border p-3" style="height: 200px; overflow-y: auto;"></div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/story-edit.js') }}"></script>
{% endblock %}
